{"title":"openEuler Embedded 交叉编译","uid":"51abce8d287243a8415fa6cdbda1af32","slug":"openEuler-Embedded-交叉编译","date":"2024-03-04T08:20:19.000Z","updated":"2024-03-04T09:06:51.991Z","comments":true,"path":"api/articles/openEuler-Embedded-交叉编译.json","keywords":null,"cover":[],"content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>💡 Tips：openEuler Embedded 是基于 openEuler 社区面向嵌入式场景的 Linux 版本，旨在成为一个高质量的以 Linux 为中心的嵌入式系统软件平台。</p></blockquote>\n<h3 id=\"编译-QMEU-7-0-0\"><a href=\"#编译-QMEU-7-0-0\" class=\"headerlink\" title=\"编译 QMEU 7.0.0\"></a>编译 QMEU 7.0.0</h3><p>欧拉 22.03 TLS SP1 官方文档当中有提到使用 qmeu 的版本建议是在 5.0 以上版本，以下是在 Ubuntu20.04 上编译 QEMU 7.0 的步骤。</p>\n<h4 id=\"安装依赖\"><a href=\"#安装依赖\" class=\"headerlink\" title=\"安装依赖\"></a>安装依赖</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install build-essential libglib2.0-dev libpixman-1-dev libfdt-dev zlib1g-dev libssl-dev libgmp-dev libmpfr-dev libmpc-dev</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"下载-QEMU-7-0-的源码\"><a href=\"#下载-QEMU-7-0-的源码\" class=\"headerlink\" title=\"下载 QEMU 7.0 的源码\"></a>下载 QEMU 7.0 的源码</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://download.qemu.org/qemu-7.0.0.tar.xz &amp;&amp; \\</span><br><span class=\"line\">tar -xf qemu-7.0.0.tar.xz &amp;&amp; \\</span><br><span class=\"line\"><span class=\"built_in\">cd</span> qemu-7.0.0</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"配置和编译\"><a href=\"#配置和编译\" class=\"headerlink\" title=\"配置和编译\"></a>配置和编译</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">../configure --target-list=aarch64-softmmu --enable-debug --enable-kvm --enable-virtfs --enable-vnc --enable-spice --enable-curses --enable-tools --enable-capstone --enable-guest-agent &amp;&amp; make &amp; make install</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"创建挂载镜像\"><a href=\"#创建挂载镜像\" class=\"headerlink\" title=\"创建挂载镜像\"></a>创建挂载镜像</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">qemu-system-aarch64 -M virt-4.0 -m 4G -cpu cortex-a57 -nographic -kernel zImage</span><br><span class=\"line\">-initrd &lt;openeuler-image-qemu-xxx.cpio.gz&gt; -device virtio-9p-device,fsdev=fs1,mount_tag=host -fsdev</span><br><span class=\"line\"><span class=\"built_in\">local</span>,security_model=passthrough,<span class=\"built_in\">id</span>=fs1,path=/tmp</span><br></pre></td></tr></table></figure>\n\n<div class=\"custom-quote tip\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06\"></path>\n<path stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 18H12.01\"></path>\n</svg></span>\n<p class=\"custom-quote-title\">TIP</p>\n<p><ul>\n<li>-M virt-4.0 ：使用 virt-4.0 作为虚拟机的主板型号；</li>\n<li>-m 4G ：分配 4GB 内存给虚拟机；</li>\n<li>-cpu cortex-a57 ：使用 cortex-a57 作为虚拟机的CPU；</li>\n<li>-nographic ：不使用图形界面，以纯文本方式运行虚拟机；</li>\n<li>-kernel zImage ：使用 zImage 作为虚拟机的内核；</li>\n<li>-initrd &lt;openeuler-image-qemu-xxx.cpio.gz&gt; ：使用指定的 initrd 文件启动虚拟机；</li>\n<li>-device virtio-9p-device,fsdev&#x3D;fs1,mount_tag&#x3D;host ：添加一个 virtio-9p 设备，挂载标签为 “host” 的文件系统；</li>\n<li>-fsdev local,security_model&#x3D;passthrough,id&#x3D;fs1,path&#x3D;&#x2F;tmp ：使用本地文件系统，并将其标记为 “fs1”，&#x2F;tmp 是宿主机目录这点注意了；</li>\n</ul>\n</p>\n</div>\n<h4 id=\"映射文件系统\"><a href=\"#映射文件系统\" class=\"headerlink\" title=\"映射文件系统\"></a>映射文件系统</h4><p>在 openEuler Embedded 启动并登录之后，需要运行如下命令，映射 (mount) 共享文件系统：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /tmp</span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> host</span><br><span class=\"line\">mount -t 9p -o trans=virtio,version=9p2000.L host /tmp/host</span><br></pre></td></tr></table></figure>\n\n<div class=\"custom-quote tip\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06\"></path>\n<path stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 18H12.01\"></path>\n</svg></span>\n<p class=\"custom-quote-title\">TIP</p>\n<ul>\n<li>mount ：挂载命令；</li>\n<li>-t 9p ：指定文件系统类型为 9P；</li>\n<li>-o trans&#x3D;virtio,version&#x3D;9p2000.L ：指定使用 virtio 传输和 9P 协议的版本为 9p2000.L。这将启用 virtio-9p 设备的支持；</li>\n<li>host ：指定要挂载的文件系统的标记名称；</li>\n<li>&#x2F;tmp&#x2F;host ：指定要将文件系统挂载到的本地目录；</li>\n</ul>\n<p>注意：此时挂载的是宿主机的 tmp 目录。用户名为：root 密码为：openEuler12#$</p>\n\n</div>\n<h3 id=\"安装工具链\"><a href=\"#安装工具链\" class=\"headerlink\" title=\"安装工具链\"></a>安装工具链</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 官方工具链地址：https://repo.openeuler.org/openEuler-22.03-LTS-SP1/embedded_img/arm64/aarch64-std</span></span><br><span class=\"line\">sh openeuler-glibc-x86_64-openeuler-image-aarch64-qemu-aarch64-toolchain-22.03.sh</span><br></pre></td></tr></table></figure>\n\n<div class=\"custom-quote tip\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06\"></path>\n<path stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 18H12.01\"></path>\n</svg></span>\n<p class=\"custom-quote-title\">TIP</p>\n<p><p>默认安装到：&#x2F;usr&#x2F;local 目录下，建议自行定义安装目录。</p>\n</p>\n</div>\n<div align=center><img src=\"https://cdn.jsdelivr.net/gh/NezhaGrin/MyImages/20240304164624.png\"></div>\n\n<h3 id=\"编译应用程序\"><a href=\"#编译应用程序\" class=\"headerlink\" title=\"编译应用程序\"></a>编译应用程序</h3><ul>\n<li>编译环境：X86 平台 + Ubuntu 18 + Ubuntu 20.04；</li>\n<li>调试环境：arm64 + OpenEuler Embedded 22.03 TLS；</li>\n<li>需求：使用 OpenEuler 交叉编译工具链成功编译应用程序(hello world)即可；</li>\n</ul>\n<h4 id=\"编译应用程序模板\"><a href=\"#编译应用程序模板\" class=\"headerlink\" title=\"编译应用程序模板\"></a>编译应用程序模板</h4><figure class=\"highlight makefile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CC = SDK-gcc <span class=\"comment\"># 官方 gcc 工具链</span></span><br><span class=\"line\">CFLAGS = -Wall</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">all: hello</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">hello: hello.o</span></span><br><span class=\"line\">\t<span class=\"variable\">$(CC)</span> <span class=\"variable\">$(CFLAGS)</span> hello.o -o hello</span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"section\">hello.o: hello.c</span></span><br><span class=\"line\">\t<span class=\"variable\">$(CC)</span> <span class=\"variable\">$(CFLAGS)</span> -c hello.c</span><br><span class=\"line\">\t</span><br><span class=\"line\"><span class=\"section\">clean:</span></span><br><span class=\"line\">\trm -f hello.o hello</span><br></pre></td></tr></table></figure>\n\n<div align=center><img src=\"https://cdn.jsdelivr.net/gh/NezhaGrin/MyImages/20240304165134.png\"></div>\n\n<h3 id=\"编译内核模块\"><a href=\"#编译内核模块\" class=\"headerlink\" title=\"编译内核模块\"></a>编译内核模块</h3><ul>\n<li>编译环境：X86 平台 + Ubuntu 18 + Ubuntu 20.04；</li>\n<li>调试环境：arm64 + OpenEuler Embedded 22.03 TLS；</li>\n<li>需求：使用 OpenEuler 交叉编译工具链成功编译内核模块(hello world)即可；</li>\n</ul>\n<h4 id=\"编译内核模块模版\"><a href=\"#编译内核模块模版\" class=\"headerlink\" title=\"编译内核模块模版\"></a>编译内核模块模版</h4><figure class=\"highlight makefile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Makefile 4.0</span></span><br><span class=\"line\">obj-m := hello.o</span><br><span class=\"line\">CURRENT_PATH := <span class=\"variable\">$(<span class=\"built_in\">shell</span> pwd)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#LINUX_KERNEL := $(shell uname -r)</span></span><br><span class=\"line\"><span class=\"comment\">#LINUX_KERNEL_PATH := /usr/src/linux-headers-$(LINUX_KERNEL)</span></span><br><span class=\"line\">LINUX_KERNEL_PATH := SDK/sysroots/aarch64-openeuler-linux/usr/src/kernel <span class=\"comment\"># SDK 就是官方提供的工具链</span></span><br><span class=\"line\"></span><br><span class=\"line\">EXTRA_CFLAGS += -Wfatal-errors</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> CROSS_COMPILE=SDK/sysroots/x86_64-openeulersdk-linux/usr/bin/aarch64-</span><br><span class=\"line\">openeuler-linux</span><br><span class=\"line\"><span class=\"keyword\">export</span> ARCH=arm64</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">all:</span></span><br><span class=\"line\">\tmake -C <span class=\"variable\">$(LINUX_KERNEL_PATH)</span> M=<span class=\"variable\">$(CURRENT_PATH)</span> modules</span><br><span class=\"line\"><span class=\"section\">help:</span></span><br><span class=\"line\">\tmake -C <span class=\"variable\">$(LINUX_KERNEL_PATH)</span> M=<span class=\"variable\">$(CURRENT_PATH)</span> help</span><br><span class=\"line\"><span class=\"section\">clean:</span></span><br><span class=\"line\">\tmake -C <span class=\"variable\">$(LINUX_KERNEL_PATH)</span> M=<span class=\"variable\">$(CURRENT_PATH)</span> clean</span><br></pre></td></tr></table></figure>\n\n<div align=center><img src=\"https://cdn.jsdelivr.net/gh/NezhaGrin/MyImages/20240304165804.png\"></div>\n\n<h3 id=\"编译内核\"><a href=\"#编译内核\" class=\"headerlink\" title=\"编译内核\"></a>编译内核</h3><ul>\n<li>编译环境：X86 平台 + Ubuntu 18 + Ubuntu 20.04；</li>\n<li>调试环境：arm64 + OpenEuler Embedded 22.03 TLS；</li>\n<li>需求：使用 OpenEuler 交叉编译工具链成功编译内核模即可；</li>\n<li>官方内核地址：<a href=\"https://gitee.com/openeuler/kernel%EF%BC%9B\">https://gitee.com/openeuler/kernel；</a></li>\n</ul>\n<h4 id=\"编译\"><a href=\"#编译\" class=\"headerlink\" title=\"编译\"></a>编译</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 拉取内核</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> 内核</span><br><span class=\"line\"></span><br><span class=\"line\">// 环境变量</span><br><span class=\"line\"><span class=\"built_in\">export</span> ARCH=arm64</span><br><span class=\"line\"><span class=\"built_in\">export</span> CROSS_COMPILE=SDK</span><br><span class=\"line\"></span><br><span class=\"line\">// 默认配置</span><br><span class=\"line\"><span class=\"built_in\">cp</span> <span class=\"built_in\">arch</span>/arm64/configs/openeuler_defconfig .config</span><br><span class=\"line\">make menuconfig</span><br><span class=\"line\"></span><br><span class=\"line\">// 编译内核</span><br><span class=\"line\">make</span><br><span class=\"line\"></span><br><span class=\"line\">// 转换为 zImage</span><br><span class=\"line\">CROSS_COMPILE-objcopy -O binary vmlinux zImage</span><br></pre></td></tr></table></figure>\n\n<p>vmlinux：Linux 内核编译出来的原始的内核文件，elf 格式，未做压缩处理。该映像可用于定位内核问题，但不能直接引导 Linux 系统启动：</p>\n<div align=center><img src=\"https://cdn.jsdelivr.net/gh/NezhaGrin/MyImages/20240304170133.png\"></div>\n\n<p>zImage：使用 gzip 压缩 Image 后，使用 objcopy 命令生成的 Linux 内核映像。该映像一般作为 uboot 的引导映像文件：</p>\n<div align=center><img src=\"https://cdn.jsdelivr.net/gh/NezhaGrin/MyImages/20240304170222.png\"></div>\n\n<h4 id=\"qemu-测试\"><a href=\"#qemu-测试\" class=\"headerlink\" title=\"qemu 测试\"></a>qemu 测试</h4><div align=center><img src=\"https://cdn.jsdelivr.net/gh/NezhaGrin/MyImages/20240304170357.png\"></div>\n\n<h4 id=\"物理机测试\"><a href=\"#物理机测试\" class=\"headerlink\" title=\"物理机测试\"></a>物理机测试</h4><div align=center><img src=\"https://cdn.jsdelivr.net/gh/NezhaGrin/MyImages/8e7d4b0251061ece1913ddeb450c875.png\"></div>","feature":true,"text":"openEuler Embedded 是基于 openEuler 社区面向嵌入式场景的 Linux 版本，旨在成为一个高质量的以 Linux 为中心的嵌入式系统软件平台。...","permalink":"/post/openEuler-Embedded-交叉编译","photos":[],"count_time":{"symbolsCount":"3.7k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"openEuler Embedded","slug":"openEuler-Embedded","count":1,"path":"api/tags/openEuler-Embedded.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91-QMEU-7-0-0\"><span class=\"toc-text\">编译 QMEU 7.0.0</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96\"><span class=\"toc-text\">安装依赖</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BD-QEMU-7-0-%E7%9A%84%E6%BA%90%E7%A0%81\"><span class=\"toc-text\">下载 QEMU 7.0 的源码</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E5%92%8C%E7%BC%96%E8%AF%91\"><span class=\"toc-text\">配置和编译</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BA%E6%8C%82%E8%BD%BD%E9%95%9C%E5%83%8F\"><span class=\"toc-text\">创建挂载镜像</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F\"><span class=\"toc-text\">映射文件系统</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%E5%B7%A5%E5%85%B7%E9%93%BE\"><span class=\"toc-text\">安装工具链</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F\"><span class=\"toc-text\">编译应用程序</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%A8%A1%E6%9D%BF\"><span class=\"toc-text\">编译应用程序模板</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97\"><span class=\"toc-text\">编译内核模块</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%86%85%E6%A0%B8%E6%A8%A1%E5%9D%97%E6%A8%A1%E7%89%88\"><span class=\"toc-text\">编译内核模块模版</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%86%85%E6%A0%B8\"><span class=\"toc-text\">编译内核</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91\"><span class=\"toc-text\">编译</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#qemu-%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">qemu 测试</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%89%A9%E7%90%86%E6%9C%BA%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">物理机测试</span></a></li></ol></li></ol>","author":{"name":"哪吒","slug":"blog-author","avatar":"https://pic.imgdb.cn/item/65ba193b871b83018a65323c.jpg","link":"/","description":"人心中的成见就像一座大山，任你怎么努力也休想搬动。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"VK-GL-CTS 编译","uid":"aa00e35aacd87969b6ac07d7e9f82352","slug":"VK-GL-CTS-编译","date":"2024-03-04T09:15:07.000Z","updated":"2024-03-04T09:35:24.808Z","comments":true,"path":"api/articles/VK-GL-CTS-编译.json","keywords":null,"cover":null,"text":"VK-GL-CTS 是一个由 Khronos Group 维护的开源项目，旨在测试 OpenGL 和 Vulkan 实现的符合性。它的主要目的是确保不同平台上的 OpenGL 和 Vulkan 实现都符合 Khronos Group 发布的规范，以此来保证应用程序在各种环境下的可移植性和稳定性。...","permalink":"/post/VK-GL-CTS-编译","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"CTS","slug":"CTS","count":1,"path":"api/tags/CTS.json"}],"author":{"name":"哪吒","slug":"blog-author","avatar":"https://pic.imgdb.cn/item/65ba193b871b83018a65323c.jpg","link":"/","description":"人心中的成见就像一座大山，任你怎么努力也休想搬动。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"交叉编译 qmake 5.12.x","uid":"5a040845bcb3e7fc650ea2e47925d186","slug":"交叉编译-qmake-5-12-x","date":"2024-03-04T07:11:11.000Z","updated":"2024-03-04T09:09:42.105Z","comments":true,"path":"api/articles/交叉编译-qmake-5-12-x.json","keywords":null,"cover":[],"text":"源码交叉编译 qmake 5.12.12 版本。以龙芯 3A5000 做为示例，适用于所有的交叉编译，套路都是一个样子。这里以龙芯 3A5000 举例，是因为 3A5000 是 Loongarch 架构比较特殊一些，需要改动一下 5.12.12 的源码。...","permalink":"/post/交叉编译-qmake-5-12-x","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"qmake","slug":"qmake","count":1,"path":"api/tags/qmake.json"}],"author":{"name":"哪吒","slug":"blog-author","avatar":"https://pic.imgdb.cn/item/65ba193b871b83018a65323c.jpg","link":"/","description":"人心中的成见就像一座大山，任你怎么努力也休想搬动。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}