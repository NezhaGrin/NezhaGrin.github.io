{"title":"PHP å¤šè¿›ç¨‹å®šæ—¶ä»»åŠ¡","uid":"a9a874d78a99ce0f41c468a49561eea5","slug":"PHP-å¤šè¿›ç¨‹å®šæ—¶ä»»åŠ¡","date":"2024-03-01T09:36:18.000Z","updated":"2024-03-01T10:17:29.817Z","comments":true,"path":"api/articles/PHP-å¤šè¿›ç¨‹å®šæ—¶ä»»åŠ¡.json","keywords":null,"cover":null,"content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>ğŸ’¡ Tipsï¼šPHP å®ç°å¤šè¿›ç¨‹çš„æ–¹å¼å¾ˆå¤šï¼Œå¯ä»¥ç”¨æ‰©å±•åº“ï¼špcntlã€swoole æˆ–è€…ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼šWorkermanã€‚è™½ç„¶ä»–ä»¬éƒ½å¾ˆå¼ºå¤§ï¼Œä½†éƒ½éœ€è¦ä¸€å®šçš„å­¦ä¹ æˆæœ¬ã€‚</p></blockquote>\n<h3 id=\"Supervisor\"><a href=\"#Supervisor\" class=\"headerlink\" title=\"Supervisor\"></a>Supervisor</h3><p>Supervisor æ˜¯ç”¨ python å¼€å‘çš„ä¸€ä¸ªåœ¨ Linux ç³»ç»Ÿä¸‹çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿çš„ç›‘å¬ã€å¯åŠ¨ã€åœæ­¢ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ã€‚ä½¿ç”¨æ›´åŠ çš„ç®€å•ã€å¥½ç®¡ç†ã€‚</p>\n<h3 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install supervisor</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å‘½ä»¤\"><a href=\"#å‘½ä»¤\" class=\"headerlink\" title=\"å‘½ä»¤\"></a>å‘½ä»¤</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å¯åŠ¨</span></span><br><span class=\"line\">supervisorctl start ç¨‹åºå</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åœæ­¢</span></span><br><span class=\"line\">supervisorctl stop ç¨‹åºå</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é‡å¯</span></span><br><span class=\"line\">supervisorctl restart ç¨‹åºå</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é‡æ–°åŠ è½½é…ç½®</span></span><br><span class=\"line\">supervisorctl reload</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æŸ¥çœ‹çŠ¶æ€</span></span><br><span class=\"line\">supervisorctl status</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"é…ç½®\"><a href=\"#é…ç½®\" class=\"headerlink\" title=\"é…ç½®\"></a>é…ç½®</h3><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">program:task</span>]</span><br><span class=\"line\"><span class=\"string\">process_name=%(program_name)s_%(process_num)02d</span></span><br><span class=\"line\"><span class=\"string\">command=/usr/bin/php</span> <span class=\"string\">/app/artisan</span> <span class=\"string\">batch:store</span> <span class=\"string\">--id=%(process_num)02d</span> <span class=\"string\">--max=1</span></span><br><span class=\"line\"><span class=\"string\">autostart=true</span></span><br><span class=\"line\"><span class=\"string\">autorestart=true</span></span><br><span class=\"line\"><span class=\"string\">user=root</span></span><br><span class=\"line\"><span class=\"string\">numprocs=8</span> <span class=\"comment\"># è¿›ç¨‹æ•°é‡</span></span><br><span class=\"line\"><span class=\"string\">redirect_stderr=true</span></span><br><span class=\"line\"><span class=\"string\">stdout_logfile=/etc/supervisor/store.log</span></span><br></pre></td></tr></table></figure>\n\n<div class=\"custom-quote tip\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06\"></path>\n<path stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 18H12.01\"></path>\n</svg></span>\n<p class=\"custom-quote-title\">TIP</p>\n<p>è¦å…ˆä¿®æ”¹ <strong>&#x2F;etc&#x2F;supervisord.conf é…ç½®æ–‡ä»¶å½“ä¸­çš„ filesï¼Œæ”¹ä¸ºï¼šfiles &#x3D; &#x2F;etc&#x2F;supervisord.d&#x2F;*.confï¼Œ</strong>ç„¶ååœ¨ &#x2F;etc&#x2F;supervisor&#x2F;conf.d ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª conf æ–‡ä»¶ã€‚</p>\n</div>\n<h3 id=\"æ‰§è¡Œ\"><a href=\"#æ‰§è¡Œ\" class=\"headerlink\" title=\"æ‰§è¡Œ\"></a>æ‰§è¡Œ</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">supervisord -c /etc/supervisord.conf</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Laravel-å®ç°\"><a href=\"#Laravel-å®ç°\" class=\"headerlink\" title=\"Laravel å®ç°\"></a>Laravel å®ç°</h3><h4 id=\"Redis-é”\"><a href=\"#Redis-é”\" class=\"headerlink\" title=\"Redis é”\"></a>Redis é”</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title class_\">App</span>\\<span class=\"title class_\">Services</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Redis</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LockService</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Redis</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$redis</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Token</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$token</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * prefix</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$prefix</span> = <span class=\"string\">&#x27;redis-lock-&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * value</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"keyword\">const</span> <span class=\"variable constant_\">VALUE</span> = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æœåŠ¡åˆå§‹åŒ–,å•æœºé”</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> Redis|null $redis</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\">Redis <span class=\"variable\">$redis</span> = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;redis = <span class=\"variable\">$redis</span> ?: <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">createRedis</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆ›å»º Redis å®ä¾‹</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> Redis</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">createRedis</span>(<span class=\"params\"></span>): <span class=\"title\">Redis</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$redis</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Redis</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable\">$redis</span>-&gt;<span class=\"title function_ invoke__\">connect</span>(<span class=\"title function_ invoke__\">config</span>(<span class=\"string\">&#x27;database.redis.default.host&#x27;</span>), <span class=\"title function_ invoke__\">config</span>(<span class=\"string\">&#x27;database.redis.default.port&#x27;</span>));</span><br><span class=\"line\">        <span class=\"variable\">$redis</span>-&gt;<span class=\"title function_ invoke__\">auth</span>(<span class=\"title function_ invoke__\">config</span>(<span class=\"string\">&#x27;database.redis.default.password&#x27;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable\">$redis</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åŠ é”</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> string $key</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> int $ttl</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> int $retry</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> bool</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span>  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">lock</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$key</span>,<span class=\"keyword\">int</span> <span class=\"variable\">$ttl</span> = <span class=\"number\">1</span>,<span class=\"keyword\">int</span> <span class=\"variable\">$retry</span> = <span class=\"number\">3</span></span>) : <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;redis-&gt;<span class=\"title function_ invoke__\">set</span>(<span class=\"variable\">$this</span>-&gt;prefix . <span class=\"variable\">$key</span>,<span class=\"built_in\">self</span>::<span class=\"variable constant_\">VALUE</span>, [<span class=\"string\">&#x27;NX&#x27;</span>, <span class=\"string\">&#x27;EX&#x27;</span> =&gt; <span class=\"variable\">$ttl</span>]))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">elseif</span> (<span class=\"variable language_\">$this</span>-&gt;redis-&gt;<span class=\"title function_ invoke__\">ttl</span>(<span class=\"variable\">$this</span>-&gt;prefix . <span class=\"variable\">$key</span>) === -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// ä»¥é˜²å‡ºç°æ­»é”</span></span><br><span class=\"line\">                <span class=\"variable language_\">$this</span>-&gt;redis-&gt;<span class=\"title function_ invoke__\">expire</span>(<span class=\"variable\">$this</span>-&gt;prefix . <span class=\"variable\">$key</span>,<span class=\"variable\">$ttl</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable\">$retry</span>-- &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"title function_ invoke__\">usleep</span>(<span class=\"number\">10000</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * è§£é”</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> string $key</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> bool</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">unlock</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$key</span></span>) : <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"variable language_\">$this</span>-&gt;redis-&gt;<span class=\"title function_ invoke__\">get</span>(<span class=\"variable\">$this</span>-&gt;prefix . <span class=\"variable\">$key</span>)) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;redis-&gt;<span class=\"title function_ invoke__\">multi</span>();</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;redis-&gt;<span class=\"title function_ invoke__\">del</span>(<span class=\"variable\">$this</span>-&gt;prefix . <span class=\"variable\">$key</span>);</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;redis-&gt;<span class=\"title function_ invoke__\">exec</span>();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"å¼€å§‹ä»»åŠ¡\"><a href=\"#å¼€å§‹ä»»åŠ¡\" class=\"headerlink\" title=\"å¼€å§‹ä»»åŠ¡\"></a>å¼€å§‹ä»»åŠ¡</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title class_\">App</span>\\<span class=\"title class_\">Console</span>\\<span class=\"title class_\">Commands</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Console</span>\\<span class=\"title\">Command</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">App</span>\\<span class=\"title\">Services</span>\\<span class=\"title\">MultiProgressService</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BatchSearchTask</span> <span class=\"keyword\">extends</span> <span class=\"title\">Command</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * The name and signature of the console command.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@var</span> string</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$signature</span> = <span class=\"string\">&#x27;batch:search</span></span><br><span class=\"line\"><span class=\"string\">        &#123;--id=      : å½“å‰ç¼–å·&#125;</span></span><br><span class=\"line\"><span class=\"string\">        &#123;--max=     : æœ€å¤§çº¿ç¨‹&#125;</span></span><br><span class=\"line\"><span class=\"string\">        &#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * The console command description.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@var</span> string</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$description</span> = <span class=\"string\">&#x27;batch mode data search&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Create a new command instance.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> void</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">parent</span>::<span class=\"title function_ invoke__\">__construct</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Execute the console command.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> mixed</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// åˆå§‹åŒ–è¿›ç¨‹</span></span><br><span class=\"line\">        <span class=\"variable\">$service</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">MultiProgressService</span>(</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">option</span>(<span class=\"string\">&#x27;id&#x27;</span>) ?? <span class=\"number\">00</span>,</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">option</span>(<span class=\"string\">&#x27;max&#x27;</span>) ?? <span class=\"number\">8</span></span><br><span class=\"line\">        );</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// å¼€å§‹ä»»åŠ¡</span></span><br><span class=\"line\">        <span class=\"variable\">$service</span>-&gt;<span class=\"title function_ invoke__\">start</span>(<span class=\"string\">&#x27;search&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"å¤„ç†ä»»åŠ¡\"><a href=\"#å¤„ç†ä»»åŠ¡\" class=\"headerlink\" title=\"å¤„ç†ä»»åŠ¡\"></a>å¤„ç†ä»»åŠ¡</h4><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title class_\">App</span>\\<span class=\"title class_\">Services</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Carbon</span>\\<span class=\"title\">Carbon</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Webpatser</span>\\<span class=\"title\">Uuid</span>\\<span class=\"title\">Uuid</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Support</span>\\<span class=\"title\">Facades</span>\\<span class=\"title\">DB</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Illuminate</span>\\<span class=\"title\">Support</span>\\<span class=\"title\">Facades</span>\\<span class=\"title\">Log</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">App</span>\\<span class=\"title\">Facades</span>\\<span class=\"title\">UserBatchSearchNumber</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">App</span>\\<span class=\"title\">Facades</span>\\<span class=\"title\">UserBatchSearchRecording</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">App</span>\\<span class=\"title\">Services</span>\\<span class=\"title\">V1</span>\\<span class=\"title\">Front</span>\\<span class=\"title\">SingleModeService</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MultiProgressService</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ä»»åŠ¡ç¼–å·</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@var</span> int</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$id</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * æœ€å¤§è¿›ç¨‹</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@var</span> int</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$max</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å•æ¬¡æœåŠ¡</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$single</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * é”æœåŠ¡</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$lock</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * åˆå§‹åŒ–æœåŠ¡</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> int $id</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> int $max</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"keyword\">int</span> <span class=\"variable\">$id</span>,<span class=\"keyword\">int</span> <span class=\"variable\">$max</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;id = <span class=\"variable\">$id</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;max = <span class=\"variable\">$max</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;lock = <span class=\"keyword\">new</span> <span class=\"title class_\">LockService</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;single = <span class=\"keyword\">new</span> <span class=\"title class_\">SingleModeService</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * å¼€å§‹ä»»åŠ¡</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> string $drive</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> int $ttl</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> bool</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">start</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$drive</span> = <span class=\"string\">&#x27;store&#x27;</span>,<span class=\"variable\">$ttl</span> = <span class=\"number\">600</span></span>) : <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// è¶…è¿‡è§„å®šçš„è¿›ç¨‹æ•°ä¸åšä»»ä½•å¤„ç†å°±è¿”å›</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;id &gt;= <span class=\"variable language_\">$this</span>-&gt;max) &#123;</span><br><span class=\"line\">              <span class=\"title function_ invoke__\">usleep</span>(<span class=\"number\">1000</span> * <span class=\"number\">1000</span>); <span class=\"comment\">// sleep 1 ç§’ï¼Œå› ä¸º Supervisor çš„ startsecs é»˜è®¤å°±æ˜¯ä¸€ç§’</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          <span class=\"comment\">// è®°å½•å½“å‰è¿›ç¨‹ä¸é©±åŠ¨ï¼Œä½œä¸º Key</span></span><br><span class=\"line\">        <span class=\"variable\">$name</span> = <span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&#x27;task:%03d:%s&#x27;</span>, <span class=\"variable\">$this</span>-&gt;id, <span class=\"variable\">$drive</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// åŠ é”æˆåŠŸè¿›å…¥é€»è¾‘æ‰§è¡Œ</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;lock-&gt;<span class=\"title function_ invoke__\">lock</span>(<span class=\"variable\">$name</span>,<span class=\"variable\">$ttl</span>)) &#123;</span><br><span class=\"line\">                              <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">search</span>();</span><br><span class=\"line\">                <span class=\"variable language_\">$this</span>-&gt;lock-&gt;<span class=\"title function_ invoke__\">unlock</span>(<span class=\"variable\">$name</span>); <span class=\"comment\">// æ‰§è¡Œå®Œä¹‹åè§£é”</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (\\<span class=\"built_in\">Exception</span> <span class=\"variable\">$e</span>) &#123;</span><br><span class=\"line\">            <span class=\"title class_\">Log</span>::<span class=\"title function_ invoke__\">channel</span>(<span class=\"string\">&#x27;task&#x27;</span>)-&gt;<span class=\"title function_ invoke__\">debug</span>(<span class=\"variable\">$drive</span>,[</span><br><span class=\"line\">                <span class=\"string\">&#x27;line&#x27;</span> =&gt; <span class=\"variable\">$e</span>-&gt;<span class=\"title function_ invoke__\">getLine</span>(),</span><br><span class=\"line\">                <span class=\"string\">&#x27;message&#x27;</span> =&gt; <span class=\"variable\">$e</span>-&gt;<span class=\"title function_ invoke__\">getMessage</span>(),</span><br><span class=\"line\">                <span class=\"string\">&#x27;code&#x27;</span> =&gt; <span class=\"variable\">$e</span>-&gt;<span class=\"title function_ invoke__\">getCode</span>(),</span><br><span class=\"line\">                <span class=\"string\">&#x27;file&#x27;</span> =&gt; <span class=\"variable\">$e</span>-&gt;<span class=\"title function_ invoke__\">getFile</span>(),</span><br><span class=\"line\">                <span class=\"string\">&#x27;progress_id&#x27;</span> =&gt; <span class=\"variable\">$this</span>-&gt;id,</span><br><span class=\"line\">                <span class=\"string\">&#x27;max_progress_number&#x27;</span> =&gt; <span class=\"variable\">$this</span>-&gt;max,</span><br><span class=\"line\">                <span class=\"string\">&#x27;lock_name&#x27;</span> =&gt; <span class=\"variable\">$name</span>,</span><br><span class=\"line\">                <span class=\"string\">&#x27;is_unlock&#x27;</span> =&gt; <span class=\"variable\">$this</span>-&gt;lock-&gt;<span class=\"title function_ invoke__\">unlock</span>(<span class=\"variable\">$name</span>)</span><br><span class=\"line\">            ]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// æ‚²è§‚çš„æƒ…å†µä¸‹,å› ä¸º Supervisor æ‰§è¡Œå»¶æ—¶æœ€ä½ 1 ç§’éœ€è¦éªŒè¯è¿›ç¨‹æ˜¯å¦è¿˜åœ¨è¿è¡Œï¼Œå¦‚æœä¸æ˜¯åœ¨è¿è¡Œé‚£ä¹ˆä¼š Errorï¼Œé”å®š 1 ç§’é’Ÿã€‚</span></span><br><span class=\"line\">        <span class=\"title function_ invoke__\">usleep</span>(<span class=\"number\">1000</span> * <span class=\"number\">1000</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","text":"Supervisor æ˜¯ç”¨ python å¼€å‘çš„ä¸€ä¸ªåœ¨ Linux ç³»ç»Ÿä¸‹çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿çš„ç›‘å¬ã€å¯åŠ¨ã€åœæ­¢ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ã€‚ä½¿ç”¨æ›´åŠ çš„ç®€å•ã€å¥½ç®¡ç†ã€‚...","permalink":"/post/PHP-å¤šè¿›ç¨‹å®šæ—¶ä»»åŠ¡","photos":[],"count_time":{"symbolsCount":"6.7k","symbolsTime":"6 mins."},"categories":[],"tags":[{"name":"PHP","slug":"PHP","count":5,"path":"api/tags/PHP.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Supervisor\"><span class=\"toc-text\">Supervisor</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">å®‰è£…</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">å‘½ä»¤</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">é…ç½®</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%89%A7%E8%A1%8C\"><span class=\"toc-text\">æ‰§è¡Œ</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Laravel-%E5%AE%9E%E7%8E%B0\"><span class=\"toc-text\">Laravel å®ç°</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Redis-%E9%94%81\"><span class=\"toc-text\">Redis é”</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%BC%80%E5%A7%8B%E4%BB%BB%E5%8A%A1\"><span class=\"toc-text\">å¼€å§‹ä»»åŠ¡</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%A4%84%E7%90%86%E4%BB%BB%E5%8A%A1\"><span class=\"toc-text\">å¤„ç†ä»»åŠ¡</span></a></li></ol></li></ol>","author":{"name":"å“ªå’","slug":"blog-author","avatar":"https://pic.imgdb.cn/item/65ba193b871b83018a65323c.jpg","link":"/","description":"äººå¿ƒä¸­çš„æˆè§å°±åƒä¸€åº§å¤§å±±ï¼Œä»»ä½ æ€ä¹ˆåŠªåŠ›ä¹Ÿä¼‘æƒ³æ¬åŠ¨ã€‚","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"PHP å¾ªç¯å¼•ç”¨çš„å‘","uid":"56806a86a18bd19533ab1028ba81c230","slug":"PHP-å¾ªç¯å¼•ç”¨çš„å‘","date":"2024-03-01T09:36:28.000Z","updated":"2024-03-01T10:46:44.206Z","comments":true,"path":"api/articles/PHP-å¾ªç¯å¼•ç”¨çš„å‘.json","keywords":null,"cover":null,"text":"å®é™…å¼€å‘å·¥ä½œä¸­ï¼Œå¾ªç¯æ˜¯ç”¨çš„å¾ˆå¤šçš„ä¸€ç§å¤„ç†æ•°æ®çš„æ–¹å¼ï¼Œè™½ç„¶æœ€å¸¸ç”¨ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å­˜åœ¨å‘ã€‚...","permalink":"/post/PHP-å¾ªç¯å¼•ç”¨çš„å‘","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"å“ªå’","slug":"blog-author","avatar":"https://pic.imgdb.cn/item/65ba193b871b83018a65323c.jpg","link":"/","description":"äººå¿ƒä¸­çš„æˆè§å°±åƒä¸€åº§å¤§å±±ï¼Œä»»ä½ æ€ä¹ˆåŠªåŠ›ä¹Ÿä¼‘æƒ³æ¬åŠ¨ã€‚","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"MySQL åˆ†æ SQL æ€§èƒ½","uid":"c590da9e3fbc0033731d8478ad40382b","slug":"MySQL-åˆ†æ-SQL-æ€§èƒ½","date":"2024-02-28T04:40:33.000Z","updated":"2024-03-01T09:30:20.267Z","comments":true,"path":"api/articles/MySQL-åˆ†æ-SQL-æ€§èƒ½.json","keywords":null,"cover":[],"text":"åˆ†æ SQL è¯­å¥æ€§èƒ½æ˜¯æ¯ä¸ªåç«¯å¼€å‘éƒ½åº”è¯¥ç†Ÿæ‚‰çš„çŸ¥è¯†ã€‚MySQL æä¾›äº†ï¼šæ…¢æŸ¥è¯¢æ—¥å¿—ã€profileã€explain æ¥å¸®åŠ©åˆ†æ SQL è¯­å¥æ€§èƒ½ã€‚...","permalink":"/post/MySQL-åˆ†æ-SQL-æ€§èƒ½","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"MySQL","slug":"MySQL","count":4,"path":"api/tags/MySQL.json"}],"author":{"name":"å“ªå’","slug":"blog-author","avatar":"https://pic.imgdb.cn/item/65ba193b871b83018a65323c.jpg","link":"/","description":"äººå¿ƒä¸­çš„æˆè§å°±åƒä¸€åº§å¤§å±±ï¼Œä»»ä½ æ€ä¹ˆåŠªåŠ›ä¹Ÿä¼‘æƒ³æ¬åŠ¨ã€‚","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}